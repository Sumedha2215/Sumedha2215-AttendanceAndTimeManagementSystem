<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Time and Attendance - Construction Site</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap" rel="stylesheet" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }
    body { background-color: #f0f4f8; }
    header {
      background-color:black;
      color: white;
      padding: 30px 80px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 { font-size: 28px; }
    nav a {
      color: #fff;
      text-decoration: none;
      font-size: 16px;
      border: 1px solid #fff;
      padding: 8px 15px;
      border-radius: 5px;
      margin-left: 10px;
      transition: 0.3s;
    }
    nav a:hover {
      background-color: #fff;
      color: #2d3436;
    }
    .hero {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 50px 20px;
      color: #fff;
      text-align: center;
      position: relative;
      min-height: 500px;
      overflow: hidden;
    }
    #heroBackground {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      transition: opacity 1.3s ease-in-out;
      z-index: 0;
      opacity: 1;
    }
    .hero::after {
      content: "";
      position: absolute;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.3);
      z-index: 1;
    }
    .hero-content {
      position: relative;
      z-index: 2;
    }
    .hero h2 {
      font-size: 36px;
      margin-bottom: 20px;
      animation: moveText 6s infinite alternate ease-in-out;
    }
    @keyframes moveText {
      0% { transform: translateX(0); }
      50% { transform: translateX(20px); }
      100% { transform: translateX(-20px); }
    }
    .login-card {
      margin-top: 30px;
      background-color: #fff;
      padding: 25px 30px;
      border-radius: 15px;
      width: 320px;
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
    }
    .login-card h3 {
      margin-bottom: 15px;
      font-size: 22px;
      color: #2d3436;
    }
    .login-card input,
    .login-card select,
    .login-card button {
      width: 100%;
      margin-bottom: 12px;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    .password-container {
      position: relative;
    }
    .password-container input {
      padding-right: 40px;
    }
    .toggle-password {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      cursor: pointer;
      font-size: 14px;
      color: #555;
      user-select: none;
    }
    .login-card button {
      background-color: #2d3436;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    .login-card button:hover {
      background-color: #636e72;
    }
    .gallery {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 30px;
      padding: 50px;
    }
    .gallery img {
      width: 300px;
      height: 200px;
      border-radius: 15px;
      object-fit: cover;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .gallery img:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
    }
    .map-container {
      padding: 20px 50px;
      display: flex;
      justify-content: center;
    }
    .map-container iframe {
      width: 100%;
      max-width: 900px;
      height: 400px;
      border: 2px solid #ccc;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    footer {
      text-align: center;
      padding: 20px;
      background: #2d3436;
      color: white;
    }
    .toast {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background-color: #2ecc71;
      color: white;
      padding: 16px 25px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.4s ease, transform 0.4s ease;
      z-index: 9999;
      font-size: 15px;
    }
    .toast.error { background-color: #e74c3c; }
    #worker-register-hint {
      display: none;
      text-align: center;
      margin-top: 5px;
    }
    #worker-register-hint a {
      color: #0984e3;
      text-decoration: underline;
      font-size: 14px;
      white-space: nowrap;
    }
  </style>
</head>
<body>

<header>
  <h1>Time and Attendance Management for Construction Site</h1>
  <nav>
    <a href="#about">About Us</a>
    <a href="#contact">Contact</a>
  </nav>
</header>

<div class="hero" id="heroSection">
  <div id="heroBackground"></div>
  <div class="hero-content">
    <h2>Track Shifts, Wages & Attendance Efficiently</h2>
    <div class="login-card">
      <h3>Login</h3>
      <form id="loginForm">
        <select name="role" id="role" required>
          <option value="" disabled selected>Select Role</option>
          <option value="admin">Admin</option>
          <option value="manager">Manager</option>
          <option value="user">Worker</option>
        </select>
        <input type="email" id="email" name="email" placeholder="Enter Email" required />
        <div class="password-container">
          <input type="password" id="password" name="password" placeholder="Enter Password" required />
          <span class="toggle-password" onclick="togglePassword()">Show</span>
        </div>
        <button type="submit">Login</button>
        <div id="worker-register-hint">
          <a href="/worker-registration.html">New? Click here for registration</a>
        </div>
      </form>
    </div>
  </div>
</div>

<section class="gallery">
  <img src="/images/Crane-and-building.jpg" alt="Crane and Building" />
  <img src="/images/Blue-print.jpg" alt="Blueprint Planning" />
  <img src="/images/NewImage.jpg" alt="Labor Team" />
  <img src="/images/Photo1.jpg" alt="Construction Workers" />
</section>

<section class="map-section">
  <h2 style="text-align:center; color:#2d3436; margin-bottom: 20px;">
    Construction Site Location - Shapoorji Pallonji Construction Site, ITPO Complex, Pragati Maidan, New Delhi, India
  </h2>
  <div class="map-container">
    <iframe
      src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14010.321109933864!2d77.2333167101831!3d28.613657175426944!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x390ce36dbf2cf4e7%3A0x22236e6c541a1446!2sPragati%20Maidan%2C%20New%20Delhi%2C%20Delhi!5e0!3m2!1sen!2sin!4v1689928927784!5m2!1sen!2sin"
      allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
    </iframe>
  </div>
</section>

<section id="about" style="padding: 60px 20px; text-align: center; background-color: #e8ecef;">
  <h2>About Us</h2>
  <p style="max-width: 800px; margin: auto;">
    We help construction sites streamline workforce management through a modern, easy-to-use Time and Attendance System.
    Our platform ensures accurate shift tracking, transparent wage calculation, and efficient labor monitoring at your site.
  </p>
</section>

<section id="contact" style="padding: 60px 20px; text-align: center; background-color: #dde4ea;">
  <h2>Contact</h2>
  <p style="max-width: 800px; margin: auto;">Email: support@constructiontrack.in | Phone: +91 9876543210</p>
</section>

<footer>
  &copy; 2025 Construction Attendance System. All rights reserved.
</footer>

<script>
  const backgrounds = [
    '/images/Background.jpg',
    '/images/Image01.jpg',
    '/images/image02.jpg'
  ];
  let index = 0;
  const bgDiv = document.getElementById("heroBackground");
  bgDiv.style.backgroundImage = `url('${backgrounds[index]}')`;

  setInterval(() => {
    bgDiv.style.opacity = '0';
    setTimeout(() => {
      index = (index + 1) % backgrounds.length;
      bgDiv.style.backgroundImage = `url('${backgrounds[index]}')`;
      bgDiv.style.opacity = '1';
    }, 600);
  }, 4000);

  function togglePassword() {
    const passwordInput = document.getElementById("password");
    const toggle = document.querySelector(".toggle-password");
    if (passwordInput.type === "password") {
      passwordInput.type = "text";
      toggle.textContent = "Hide";
    } else {
      passwordInput.type = "password";
      toggle.textContent = "Show";
    }
  }

  function showToast(message, type = 'success') {
    const toast = document.createElement("div");
    toast.className = "toast" + (type === 'error' ? " error" : "");
    toast.textContent = message;
    document.body.appendChild(toast);
    requestAnimationFrame(() => {
      toast.style.opacity = '1';
      toast.style.transform = 'translateY(0)';
    });
    setTimeout(() => {
      toast.style.opacity = '0';
      toast.style.transform = 'translateY(20px)';
    }, 2500);
    setTimeout(() => { toast.remove(); }, 3000);
  }

  document.getElementById("role").addEventListener("change", function () {
    const selectedRole = this.value.toLowerCase();
    const hint = document.getElementById("worker-register-hint");
    hint.style.display = selectedRole === "user" ? "block" : "none";
  });

  document.getElementById("loginForm").addEventListener("submit", async function (e) {
    e.preventDefault();
    const email = document.getElementById("email").value.toLowerCase();
    const password = document.getElementById("password").value;
    let role = document.getElementById("role").value.toLowerCase();
    if (role === "user") role = "worker"; // âœ… REQUIRED FIX ONLY

    try {
      const response = await fetch("http://localhost:8080/api/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password, role })
      });

      if (response.ok) {
        const result = await response.text();

        if (result === "worker") {
          localStorage.setItem("workerEmail", email);
          showToast("Login successful!");
          setTimeout(() => {
            window.location.href = "worker-profile.html";
          }, 1500);
        } else {
          showToast("Login successful!");
          setTimeout(() => {
            window.location.href = result;
          }, 1500);
        }
      } else {
        const msg = await response.text();
        showToast("Login failed: " + msg, "error");
      }
    } catch (err) {
      showToast("Server error. Please try again.", "error");
    }
  });
</script>


</body>
</html>
